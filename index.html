<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Explore insights into greenhouse gas emissions trends across countries and sectors.">
    <meta name="keywords" content="Greenhouse Gas Emissions, Data Visualization, D3, Sustainability">
    <meta name="author" content="Charlene Chai and Sherman Tan">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greenhouse Gas Emissions Insights</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <nav class="navbar">
        <div class="nav-links">
            <a href="index.html#section1" class="nav-link">Project Overview</a>
            <div class="dropdown">
                <a href="javascript:void(0)" class="nav-link dropbtn">Visualisations</a>
                <div class="dropdown-content">
                    <a href="index.html#section3">Visualisation 1</a>
                    <a href="index.html#section4">Visualisation 2</a>
                    <a href="index.html#section5">Visualisation 3</a>
                </div>
            </div>
            <a href="aboutus.html" class="nav-link">About Us</a>
        </div>
    </nav>
    

    <main id="contents">
        <section id="section1">
            <div class="container">
                <h1>Greenhouse Gas Emissions Insights</h1>
                    <!-- Styled Scroll Button -->
                    <a href="#section2" id="scrollBtn">
                        <button class="styled-button">Explore Insights</button>
                    </a>
            </div>
        </section>

        <section id="section2">
            <div class="container">
                <!-- Heading at the Top -->
                <h2>Purpose of the Insights</h2>
                    <div class="content">
                        <!-- Left Column: Text Content -->
                        <div class="text-content">
                            <p>
                                Greenhouse gas emissions continue to rise globally even though actions are taken to reduce the impact of climate change. Industrial activities such as 
                                agriculture, deforestation and fossil fuels are the main contributors to global warming. Some countries have taken actions to reduce greenhouse gas 
                                emissions, but along with economic development, energy demand rises as well as greenhouse gas emissions. Although carbon dioxide is the most significant 
                                contributor to greenhouse gas emissions, other gases such as methane, nitrous, and sulphur oxide severely impact global warming. The visualisation in 
                                this project aims to provide clear visualisations to raise awareness to the public regarding the rise of greenhouse gas emissions and provide data such 
                                as emissions trends to researchers and policymakers to better enforce policies that reduce greenhouse gas emissions.  
                            </p>
                            <button id="backBtn" class="back-btn">Back</button>
                        </div>
                        
                        <!-- Right Column: Video Content -->
                        <div class="video-content">
                            <video autoplay loop muted playsinline style="width: 100%; border-radius: 8px;">
                                <source src="resource/ice-on-lake.mp4 " type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>
                    <a href="#section3" id="scrollBtn2">
                        <button class="styled-button2">Explore visualisation</button>
                    </a>
                </div>
        </section>

        <section id="section3">
            <div class="container">
                <h2 class="section-heading">Historical Trends in Global Greenhouse Gas Emissions (1850–2022)</h2>
                <div id="chart"></div> <!-- Chart container -->
                <div id="tooltip"></div> <!-- Tooltip container -->
            </div>
        
            <!-- Include D3.js -->
            <script src="https://d3js.org/d3.v7.min.js"></script> 
            <script src="vis1.js"></script> <!-- Your script -->
            <a href="#section4" id="scrollBtn3">
                <button class="styled-button3">Next</button>
            </a>            
        </section>
        
        <section id="section4">
            <div class="container">
                <h2 class="fade-in">Global Greenhouse Gas Emissions by Country (1850–2022)</h2>
                <div id="container">
                    <div id="slider-box">
                        <p>
                            Explore the <strong>"Global Greenhouse Gas Emissions by Country (1850–2022)"</strong> choropleth map, where the <strong>color intensity</strong> of each country reflects its greenhouse gas emissions in a given year, with <strong>darker shades</strong> representing higher emissions. <strong>Adjust the slider</strong> below to view emissions data across different years, dynamically updating the map to showcase historical trends. <strong>Hovering over a country</strong> displays its name and precise emissions value in the tooltip, offering <strong>detailed insights</strong> into each country's contribution to global emissions.
                        </p>
                        <input type="range" id="year-slider" min="1850" max="2022" value="1850" step="1" />
                        <span id="current-year">1850</span>
                    </div>
                    <div id="chart2"></div>
                
                <script src="vis2.js"></script>
                <a href="#section5" id="scrollBtn4">
                    <button class="styled-button4">Next</button>
                </a>            
            </div>
        </section>
        
        <section id="section5">
            <div class="container">
                <h2 class="section-heading">Global Greenhouse Gas by Sectors (2008-2022)</h2>
                <div id="chart3">
            <script src="vis3.js"></script> <!-- Your script for Section 5 -->
                </div> <!-- Chart container -->
            </div>


        </section>

    </main>

    <footer></footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
        const sections = document.querySelectorAll("section"); // Select all sections
        const headings = document.querySelectorAll(".section-heading"); // Select all headings
        const chartContainer = document.querySelector("#chart");

        let visInitialized = false;

        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        // Add fade-in effect to the visible heading
                        const heading = entry.target.querySelector(".section-heading");
                        if (heading) {
                            heading.classList.add("fade-in");
                        }

                        // Specific logic for Section 3 visualization
                        if (entry.target.id === "section3" && !visInitialized) {
                            visInitialized = true;
                            chartContainer.classList.add("fade-in");
                            init(); // Trigger the visualization animation
                        }
                    }
                });
            },
            { threshold: 0.5 } // Trigger when 50% of the section is visible
        );

        // Observe all sections
        sections.forEach((section) => {
            observer.observe(section);
        });
    });

    $(document).ready(function() {
        // Function to check if an element is in view
        function isInView(elem) {
            var elementTop = $(elem).offset().top;
            var elementBottom = elementTop + $(elem).outerHeight();
            var viewportTop = $(window).scrollTop();
            var viewportBottom = viewportTop + $(window).height();
            return elementBottom > viewportTop && elementTop < viewportBottom;
        }
        // Smooth scroll when clicking the scroll button
        $('#scrollBtn').on('click', function(e) {
            e.preventDefault();
            var target = $(this).attr('href');
            $('html, body').animate({
                scrollTop: $(target).offset().top
            }, 1000, function() {
                $('#backBtn').fadeIn();
            });
        });

        // Smooth scroll for the second button in section2
        $('#scrollBtn2').on('click', function(e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: $('#section3').offset().top
            }, 1000);
        });

        // Smooth scroll for the second button in section3
        $('#scrollBtn3').on('click', function(e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: $('#section4').offset().top
            }, 1000);
        });

        // Smooth scroll for the second button in section4
                $('#scrollBtn4').on('click', function(e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: $('#section5').offset().top
            }, 1000);
        });

        // Scroll back to section1 when clicking the back button
        $('#backBtn').on('click', function(e) {
            e.preventDefault();
            $('html, body').animate({
                scrollTop: $('#section1').offset().top
            }, 1000, function() {
                // Hide the back button after returning to section1
                $('#backBtn').fadeOut();
            });
        });

        // Optional: Hide the back button initially
        $('#backBtn').hide();

        $('.nav-link').on('click', function(e) {
            var target = $(this).attr('href');
            
            // Allow the browser to handle navigation naturally for external links
            if (!target.includes("#")) {
                window.location.href = target;
            } else {
                // Smooth scroll for internal links only within the same page
                e.preventDefault();
                var targetSection = target.split("#")[1];
                $('html, body').animate({
                    scrollTop: $("#" + targetSection).offset().top
                }, 1000);
            }
        });

        // Show/hide back button based on scroll position for section 2
        $(window).on('scroll', function() {
            const section2Top = $('#section2').offset().top;
            const section3Top = $('#section3').offset().top;
            const section4Top = $('#section4').offset().top;
            const section5Top = $('#section5').offset().top;
            const scrollPosition = $(window).scrollTop();

            // Show the back button only in section 2
            if (scrollPosition >= section2Top && scrollPosition < section3Top) {
                $('#backBtn').fadeIn();
            } else {
                $('#backBtn').fadeOut();
            }
            // Show/hide navbar based on scroll position
            if ($(window).scrollTop() >= section3Top) {
                $('.navbar').fadeIn();
            } else {
                $('.navbar').fadeOut();
            }
            // Apply fade-in effect to section headings
            $('.section-heading').each(function() {
                if (isInView(this)) {
                    $(this).addClass('visible');
                }
            });
            // Show/hide navbar based on scroll position
            if ($(window).scrollTop() >= section3Top) {
                $('.section-heading').fadeIn();
            } else {
                $('.section-heading').fadeOut();
            }
        });

        // Initially hide the navbar
        $('.navbar').hide();

        // Initially hide the navbar
        $('.section-heading').hide();

        // Initially hide the back button
        $('#backBtn').hide();


        let vis1Initialized = false;

        $(window).on('scroll', function () {
            // Check if section 3 is in view
            if (isInView('#section3') && !vis1Initialized) {
                vis1Initialized = true; // Prevent multiple initializations
                init(); // Call the init function for the visualization
            }
        });
    });

    
    document.addEventListener("DOMContentLoaded", () => {
        const section4 = document.querySelector("#section4");
        const section5 = document.querySelector("#section5");

        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.target.id === "section5") {
                        if (entry.isIntersecting) {
                            section4.style.visibility = "hidden"; // Hide Section 4
                        } else {
                            section4.style.visibility = "visible"; // Show Section 4
                        }
                    }
                });
            },
            { threshold: 0.5 } // Trigger when 50% of Section 5 is visible
        );

        observer.observe(section5);
    
    });

    document.addEventListener("DOMContentLoaded", () => {
        const section4 = document.querySelector("#section4");
        const chartContainer = document.querySelector("#chart2");

        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        chartContainer.classList.add("fade-in");
                    }
                });
            },
            { threshold: 0.5 } // Trigger when 50% of the section is visible
        );

        observer.observe(section4);
    });


    </script>

    <footer>
        <div class="footer-content">
            <p>&copy; COS30045 Data Visualisation</p>
            <p>by Charlene Chai &amp; Sherman Tan</p>
        </div>
    </footer>
</body>

</html>
